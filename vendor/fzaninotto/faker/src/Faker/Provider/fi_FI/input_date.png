1;m=n.table.rows[0].cells[z.cellIndex];"TH"==m.tagName&&(m=n.table.rows[1].cells[z.cellIndex])}for(k=0;x=b[k++];){q=m;for(v=0;t=x[v++];)m?(m.innerHTML=t.innerHTML,t.getAttribute("width")&&m.setAttribute("width",t.getAttribute("width")),t.getAttribute("vAlign")&&m.setAttribute("vAlign",t.getAttribute("vAlign")),t.getAttribute("align")&&m.setAttribute("align",t.getAttribute("align")),
t.style.cssText&&(m.style.cssText=t.style.cssText),u=m,m=m.nextSibling):(z=t.cloneNode(!0),f.removeAttributes(z,["class","rowSpan","colSpan"]),u.parentNode.appendChild(z));m=n.getNextCell(q,!0,!0);if(!b[k])break;m||(z=n.getCellInfo(q),n.table.insertRow(n.table.rows.length),n.update(),m=n.getVSideCell(q,!0))}}n.update()}else{n=h.document.createElement("table");for(k=0;x=b[k++];){u=n.insertRow(n.rows.length);for(v=0;t=x[v++];)z=G.cloneCell(t,null,!0),f.removeAttributes(z,["class"]),u.appendChild(z);
2==v&&1<z.rowSpan&&(z.rowSpan=1)}k=G.getDefaultValue(h,void 0);k=h.body.offsetWidth-2*parseInt(f.getComputedStyle(h.body,"margin-left"),10)-2*k.tableBorder-(h.options.offsetWidth||0);h.execCommand("insertHTML","<table  "+(e&&l?'width="'+k+'"':"")+">"+n.innerHTML.replace(/>\s*</g,"><").replace(/\bth\b/gi,"td")+"</table>")}h.fireEvent("contentchange");h.fireEvent("saveScene");g.html="";return!0}k=h.document.createElement("div");k.innerHTML=g.html;x=k.getElementsByTagName("table");f.findParentByTagName(h.selection.getStart(),
"table")?(p.each(x,function(a){f.remove(a)}),f.findParentByTagName(h.selection.getStart(),"caption",!0)&&(k.innerHTML=k[r.ie?"innerText":"textContent"])):p.each(x,function(b){d(b,!0);f.removeAttributes(b,["style","border"]);p.each(f.getElementsByTagName(b,"td"),function(b){a(b)&&f.fillNode(h.document,b);d(b,!0)})});g.html=k.innerHTML}});y.addListener("afterpaste",function(){p.each(f.getElementsByTagName(y.body,"table"),function(a){if(a.offsetWidth>y.body.offsetWidth){var b=G.getDefaultValue(y,a);
a.style.width=y.body.offsetWidth-2*parseInt(f.getComputedStyle(y.body,"margin-left"),10)-2*b.tableBorder-(y.options.offsetWidth||0)+"px"}})});y.addListener("blur",function(){b=null});var n;y.addListener("keydown",function(){clearTimeout(n);n=setTimeout(function(){var a=y.selection.getRange();if(a=f.findParentByTagName(a.startContainer,["th","td"],!0)){var b=a.parentNode.parentNode.parentNode;b.offsetWidth>b.getAttribute("width")&&(a.style.wordBreak="break-all")}},100)});y.addListener("selectionchange",
function(){m(y,!1,"",null)});y.addListener("contentchange",function(){var a=this;J(a);if(!G.getUETableBySelected(a)){var b=a.selection.getRange().startContainer,b=f.findParentByTagName(b,["td","th"],!0);p.each(f.getElementsByTagName(a.document,"table"),function(b){!0!==a.fireEvent("excludetable",b)&&(b.ueTable=new G(b),b.onmouseover=function(){a.fireEvent("tablemouseover",b)},b.onmousemove=function(){a.fireEvent("tablemousemove",b);a.options.tableDragable&&g(!0,this,a);p.defer(function(){a.fireEvent("contentchange",
50)},!0)},b.onmouseout=function(){a.fireEvent("tablemouseout",b);m(a,!1,"",null);J(a)},b.onclick=function(b){b=a.window.event||b;var e=c(b.target||b.srcElement);if(e){var d=N(e),g=d.table,h=d.getCellInfo(e),f=a.selection.getRange();k(g,e,b,!0)?(g=d.getCell(d.indexTable[d.rowsNum-1][h.colIndex].rowIndex,d.indexTable[d.rowsNum-1][h.colIndex].cellIndex),b.shiftKey&&d.selectedTds.length?d.selectedTds[0]!==g?(b=d.getCellsRange(d.selectedTds[0],g),d.setSelected(b)):f&&f.selectNodeContents(g).select():e!==
g?(b=d.getCellsRange(e,g),d.setSelected(b)):f&&f.selectNodeContents(g).select()):k(g,e,b)&&(g=d.getCell(d.indexTable[h.rowIndex][d.colsNum-1].rowIndex,d.indexTable[h.rowIndex][d.colsNum-1].cellIndex),b.shiftKey&&d.selectedTds.length?d.selectedTds[0]!==g?(b=d.getCellsRange(d.selectedTds[0],g),d.setSelected(b)):f&&f.selectNodeContents(g).select():e!==g?(b=d.getCellsRange(e,g),d.setSelected(b)):f&&f.selectNodeContents(g).select())}})});Q(a,!0)}});f.on(y.document,"mousemove",h);f.on(y.document,"mouseout",
